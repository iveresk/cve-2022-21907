# CVE-2022-21907 Golang Application by 1vere$k

CVE-2022-21907 - Double Free in http.sys driver.

## Summary
This is a multithreading Golang application wich allows make requests on few targets simultaneously.  
Not very productive with the POST requests but it provides nearly 30% of speed comparing to a linear method.  
An unauthenticated attacker can send an HTTP request with an "Accept-Encoding" HTTP request header triggering a double free in the unknown coding-list inside the HTTP Protocol Stack (http.sys) to process packets, resulting in a kernel crash.

## Usage 

```
Golang:
1. git clone https://github.com/iveresk/cve-2022-21907.git
2. cd cve-2022-21907
3. go cve-2022-21907.go -t <targetURL> [or <targetFile>]

Docker:
1. Will be soon
```

## Vulnerable systems

Windows Server 2019 and Windows 10 version 1809:

- Not vulnerable by default. Unless you have set the HTTP Trailer Support.
- Windows 10 version 2004 (build 19041.450): Vulnerable